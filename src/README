I. BUILD INSTRUCTIONS.

In order to build, do the following:

   cmake .
   make

You only have to run the first two lines once.

export APACHE_RUN_USER=www-data
export APACHE_RUN_GROUP=www-data
export APACHE_LOG_DIR=/var/log/apache2

gdb --annotate=3 --args /usr/sbin/apache2 -f /etc/apache2/apache2.conf -DONE_PROCESS -DNO_DETACH

* Building Ruby with Debug symbols:

Modify debian/rules as follows:

ifneq (,$(findstring noopt,$(DEB_BUILD_OPTIONS)))
	CFLAGS += -g -O0
else
	CFLAGS += -g -O0  <--
endif
ifneq (,$(findstring $(DEB_HOST_GNU_CPU),ia64))
	CFLAGS := $(patsubst -O0,,$(CFLAGS)) <--
	CFLAGS := $(patsubst -O0,,$(CFLAGS)) <--
	CFLAGS := $(patsubst -O0,,$(CFLAGS)) <--
	CFLAGS += -O0
	CXXFLAGS := $(patsubst -O0,,$(CFLAGS)) <--
	CXXFLAGS := $(patsubst -O0,,$(CFLAGS)) <--
	CXXFLAGS := $(patsubst -O0,,$(CFLAGS)) <--
	CXXFLAGS += -O0 <--
endif

ifeq ($(DEB_HOST_GNU_CPU),i386)
	DEB_CONFIGURE_USER_FLAGS += --enable-frame-address
endif
ifneq (,$(filter $(DEB_HOST_GNU_CPU),i486 i586 i686))
	DEB_CONFIGURE_USER_FLAGS += --enable-frame-address
endif
DEB_CONFIGURE_USER_FLAGS += optflags="-O0" debugflags="-g3 -ggdb" <--

See http://railsquestions.blogspot.com/2009/01/compiling-ruby-with-debug-symbols-in.html

* Ubuntu 11.10 64 not loading libc6-dbg symbols:
https://bugs.launchpad.net/ubuntu/+source/eglibc/+bug/793292


Possible bug culprit:

http://sourceware.org/bugzilla/show_bug.cgi?id=10069